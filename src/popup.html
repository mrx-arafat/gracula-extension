<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gracula Settings</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      width: 350px;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: #333;
    }

    .header {
      background: white;
      padding: 20px;
      text-align: center;
      border-bottom: 2px solid #f0f0f0;
    }

    .header h1 {
      font-size: 24px;
      margin-bottom: 4px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .header p {
      font-size: 12px;
      color: #666;
    }

    .content {
      background: white;
      padding: 20px;
    }

    .section {
      margin-bottom: 20px;
    }

    .section h2 {
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 12px;
      color: #333;
    }

    .info-box {
      background: #f8f9fa;
      border-left: 4px solid #667eea;
      padding: 12px;
      border-radius: 4px;
      font-size: 12px;
      line-height: 1.5;
      color: #666;
      margin-bottom: 16px;
    }

    .form-group {
      margin-bottom: 16px;
    }

    label {
      display: block;
      font-size: 13px;
      font-weight: 500;
      margin-bottom: 6px;
      color: #333;
    }

    input[type="text"],
    select {
      width: 100%;
      padding: 10px;
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      font-size: 13px;
      font-family: inherit;
      transition: border-color 0.2s ease;
    }

    input[type="text"]:focus,
    select:focus {
      outline: none;
      border-color: #667eea;
    }

    .hint {
      font-size: 11px;
      color: #999;
      margin-top: 4px;
    }

    /* Toggle Switch Styles */
    .toggle-switch {
      position: relative;
      display: inline-block;
      width: 50px;
      height: 26px;
    }

    .toggle-switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }

    .toggle-slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: #ccc;
      transition: 0.3s;
      border-radius: 26px;
    }

    .toggle-slider:before {
      position: absolute;
      content: "";
      height: 20px;
      width: 20px;
      left: 3px;
      bottom: 3px;
      background-color: white;
      transition: 0.3s;
      border-radius: 50%;
    }

    .toggle-switch input:checked + .toggle-slider {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }

    .toggle-switch input:checked + .toggle-slider:before {
      transform: translateX(24px);
    }

    .toggle-switch input:focus + .toggle-slider {
      box-shadow: 0 0 1px #667eea;
    }

    .btn {
      width: 100%;
      padding: 12px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
      font-family: inherit;
    }

    .btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
    }

    .btn:active {
      transform: translateY(0);
    }

    .status {
      padding: 10px;
      border-radius: 8px;
      font-size: 12px;
      text-align: center;
      margin-top: 12px;
      display: none;
    }

    .status.success {
      background: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }

    .status.error {
      background: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
    }

    .features {
      list-style: none;
      padding: 0;
    }

    .features li {
      padding: 8px 0;
      font-size: 12px;
      color: #666;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .features li::before {
      content: "✓";
      color: #667eea;
      font-weight: bold;
      font-size: 14px;
    }

    .footer {
      background: white;
      padding: 16px 20px;
      text-align: center;
      border-top: 2px solid #f0f0f0;
      font-size: 11px;
      color: #999;
    }

    .footer a {
      color: #667eea;
      text-decoration: none;
    }

    .footer a:hover {
      text-decoration: underline;
    }

    /* Status Badge Styles */
    .status-badge {
      display: inline-block;
      padding: 4px 12px;
      border-radius: 20px;
      font-size: 11px;
      font-weight: 600;
      margin-left: 8px;
    }

    .status-badge.active {
      background: #d4edda;
      color: #155724;
    }

    .status-badge.inactive {
      background: #e2e3e5;
      color: #383d41;
    }

    .status-badge.ai {
      background: #cfe2ff;
      color: #084298;
    }

    .status-badge.offline {
      background: #fff3cd;
      color: #664d03;
    }

    /* State Indicator */
    .state-indicator {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 12px;
      background: #f8f9fa;
      border-radius: 8px;
      margin-bottom: 16px;
      border-left: 4px solid #667eea;
    }

    .state-indicator .dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      animation: pulse 2s infinite;
    }

    .state-indicator .dot.active {
      background: #28a745;
    }

    .state-indicator .dot.inactive {
      background: #dc3545;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }

    .state-indicator-text {
      font-size: 12px;
      color: #666;
    }

    .state-indicator-text strong {
      color: #333;
    }

    /* Tabs */
    .tabs {
      display: flex;
      gap: 8px;
      margin-bottom: 16px;
      border-bottom: 2px solid #e0e0e0;
    }

    .tab-button {
      padding: 10px 16px;
      background: none;
      border: none;
      border-bottom: 3px solid transparent;
      cursor: pointer;
      font-size: 13px;
      font-weight: 500;
      color: #999;
      transition: all 0.2s ease;
    }

    .tab-button:hover {
      color: #667eea;
    }

    .tab-button.active {
      color: #667eea;
      border-bottom-color: #667eea;
    }

    .tab-content {
      display: none;
    }

    .tab-content.active {
      display: block;
    }

    /* Loading State */
    .loading {
      display: inline-block;
      width: 12px;
      height: 12px;
      border: 2px solid #f3f3f3;
      border-top: 2px solid #667eea;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin-right: 6px;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* Collapsible Section */
    .collapsible-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      cursor: pointer;
      padding: 12px;
      background: #f8f9fa;
      border-radius: 8px;
      margin-bottom: 12px;
      transition: background 0.2s ease;
    }

    .collapsible-header:hover {
      background: #e9ecef;
    }

    .collapsible-header.collapsed::after {
      content: "▼";
      font-size: 10px;
      color: #667eea;
    }

    .collapsible-header.expanded::after {
      content: "▲";
      font-size: 10px;
      color: #667eea;
    }

    .collapsible-content {
      display: none;
      padding: 12px;
      background: #f8f9fa;
      border-radius: 8px;
      margin-bottom: 12px;
    }

    .collapsible-content.expanded {
      display: block;
    }

    /* Badge for current mode */
    .mode-badge {
      display: inline-block;
      padding: 6px 12px;
      border-radius: 20px;
      font-size: 11px;
      font-weight: 600;
      margin-top: 8px;
    }

    .mode-badge.ai-mode {
      background: #cfe2ff;
      color: #084298;
    }

    .mode-badge.offline-mode {
      background: #fff3cd;
      color: #664d03;
    }

    /* Better spacing for sections */
    .section-divider {
      height: 1px;
      background: #e0e0e0;
      margin: 20px 0;
    }

    /* Icon styles */
    .icon {
      font-size: 16px;
      margin-right: 6px;
    }
  </style>
</head>
<body>
  <div class="header">
    <h1>🧛 Gracula</h1>
    <p>AI Reply Assistant</p>
  </div>

  <div class="content">
    <!-- Status Indicator -->
    <div class="state-indicator">
      <div class="dot active" id="statusDot"></div>
      <div class="state-indicator-text">
        <strong>Status:</strong> <span id="statusText">Ready</span>
        <span class="status-badge" id="modeBadge">Offline Mode</span>
      </div>
    </div>

    <div class="section">
      <div class="info-box">
        <strong>🎉 Welcome to Gracula!</strong><br>
        Your AI-powered reply assistant is ready. Visit any messaging platform and look for the floating Gracula button near your message input!
      </div>
    </div>

    <div class="section">
      <h2>✨ Features</h2>
      <ul class="features">
        <li>AI-powered reply generation</li>
        <li>11 different tone options</li>
        <li>Works on all messaging platforms</li>
        <li>Smart autocomplete suggestions</li>
        <li>Offline pattern-based predictions</li>
        <li>Voice-to-text input support</li>
      </ul>
    </div>

    <div class="section">
      <h2>🎯 Autocomplete Settings</h2>
      <div class="form-group">
        <label style="display: flex; align-items: center; justify-content: space-between; cursor: pointer;">
          <span style="font-weight: 600;">
            <span style="font-size: 16px;">🤖</span> AI-Powered Autosuggestions
          </span>
          <label class="toggle-switch">
            <input type="checkbox" id="aiToggle">
            <span class="toggle-slider"></span>
          </label>
        </label>
        <div class="hint" style="margin-top: 8px;">
          When enabled, uses AI to generate smart suggestions as you type. When disabled, uses offline pattern-based predictions (no API calls).
        </div>
        <div id="aiModeIndicator" style="margin-top: 8px;">
          <span class="mode-badge offline-mode">📊 Offline Mode Active</span>
        </div>
        <div class="info-box" style="margin-top: 12px; background: #fff3cd; border-left: 4px solid #ffc107;">
          <strong>💡 Tip:</strong> Disable AI suggestions to save API costs and use faster offline predictions. Enable for more contextual and intelligent suggestions.
        </div>
      </div>
    </div>

    <div class="section">
      <h2>⚙️ API Settings</h2>
      <div class="info-box">
        <strong>🔑 API Key Required</strong><br>
        Gracula supports multiple AI providers. Choose your preferred provider and add your API key below to get started.
      </div>

      <form id="settingsForm">
        <div class="form-group">
          <label for="provider">AI Provider</label>
          <select id="provider">
            <option value="openai">OpenAI (Recommended)</option>
            <option value="google">Google AI Studio (Gemini)</option>
            <option value="openrouter">OpenRouter (Free Models Available)</option>
            <option value="huggingface">Hugging Face (Free)</option>
          </select>
          <div class="hint">OpenAI provides best quality, Google AI Studio offers powerful Gemini models, OpenRouter offers free models</div>
        </div>

        <div class="form-group">
          <label for="apiKey">API Key</label>
          <input type="text" id="apiKey" placeholder="sk-proj-... or AIza... or sk-or-v1-...">
          <div class="hint" id="apiKeyHint">Required for OpenAI, Google AI Studio, and OpenRouter. Optional for Hugging Face</div>
        </div>

        <div class="form-group" id="openaiModelGroup">
          <label for="openaiModel">OpenAI Model</label>
          <select id="openaiModel">
            <option value="gpt-3.5-turbo">GPT-3.5 Turbo (Fast & Cheap)</option>
            <option value="gpt-4">GPT-4 (Best Quality)</option>
            <option value="gpt-4-turbo-preview">GPT-4 Turbo (Balanced)</option>
          </select>
        </div>

        <div class="form-group" id="googleModelGroup" style="display: none;">
          <label for="googleModel">Google AI Model</label>
          <select id="googleModel">
            <option value="gemini-2.0-flash-exp">Gemini 2.0 Flash (Experimental, Fast)</option>
            <option value="gemini-1.5-pro">Gemini 1.5 Pro (Best Quality)</option>
            <option value="gemini-1.5-flash">Gemini 1.5 Flash (Fast & Efficient)</option>
            <option value="gemini-1.5-flash-8b">Gemini 1.5 Flash 8B (Lightweight)</option>
          </select>
          <div class="hint">Get your API key at <a href="https://aistudio.google.com/apikey" target="_blank">Google AI Studio</a></div>
        </div>

        <div class="form-group" id="openrouterModelGroup" style="display: none;">
          <label for="openrouterModel">OpenRouter Model</label>
          <select id="openrouterModel">
            <option value="google/gemini-2.0-flash-exp:free">Gemini 2.0 Flash (Free)</option>
            <option value="deepseek/deepseek-chat-v3.1:free">DeepSeek Chat v3.1 (Free)</option>
            <option value="z-ai/glm-4.5-air:free">GLM 4.5 Air (Free)</option>
            <option value="moonshotai/kimi-k2:free">Kimi K2 (Free)</option>
            <option value="cognitivecomputations/dolphin-mistral-24b-venice-edition:free">Dolphin Mistral 24B (Free)</option>
            <option value="deepseek/deepseek-r1-0528-qwen3-8b:free">DeepSeek R1 Qwen3 8B (Free)</option>
            <option value="qwen/qwen3-30b-a3b:free">Qwen3 30B (Free)</option>
            <option value="meta-llama/llama-3.1-8b-instruct:free">Llama 3.1 8B (Free)</option>
            <option value="google/gemini-flash-1.5">Gemini Flash 1.5</option>
            <option value="openai/gpt-3.5-turbo">GPT-3.5 Turbo</option>
            <option value="anthropic/claude-3-haiku">Claude 3 Haiku</option>
          </select>
          <div class="hint">Get your API key at <a href="https://openrouter.ai/keys" target="_blank">openrouter.ai</a></div>
          <div class="hint" style="margin-top: 8px; color: #ff9800;">
            ⚠️ Free tier limits: 50 requests/day, 16 requests/min. <a href="https://openrouter.ai/credits" target="_blank" style="color: #ff9800;">Add credits</a> for unlimited access.
          </div>
        </div>

        <div class="form-group" id="huggingfaceModelGroup" style="display: none;">
          <label for="huggingfaceModel">Hugging Face Model</label>
          <select id="huggingfaceModel">
            <option value="mistralai/Mistral-7B-Instruct-v0.2">Mistral 7B (Recommended)</option>
            <option value="meta-llama/Llama-2-7b-chat-hf">Llama 2 7B</option>
            <option value="google/flan-t5-large">Flan-T5 Large</option>
            <option value="tiiuae/falcon-7b-instruct">Falcon 7B</option>
          </select>
        </div>

        <button type="submit" class="btn">Save Settings</button>
        <div id="status" class="status"></div>
      </form>
    </div>

    <div class="section">
      <h2>🎤 Voice-to-Text Settings</h2>
      <div class="info-box">
        <strong>🗣️ Voice Input</strong><br>
        Enable voice input to dictate messages using speech recognition. Choose from multiple providers or use the free browser-based option.
      </div>

      <form id="voiceSettingsForm">
        <div class="form-group">
          <label style="display: flex; align-items: center; justify-content: space-between; cursor: pointer;">
            <span style="font-weight: 600;">
              <span style="font-size: 16px;">🎙️</span> Enable Voice Input
            </span>
            <label class="toggle-switch">
              <input type="checkbox" id="voiceToggle">
              <span class="toggle-slider"></span>
            </label>
          </label>
          <div class="hint" style="margin-top: 8px;">
            When enabled, press <strong>Ctrl+Shift+V</strong> or click the microphone button to start voice input.
          </div>
        </div>

        <div class="form-group">
          <label for="voiceProvider">Voice Provider</label>
          <select id="voiceProvider">
            <option value="webspeech">Web Speech API (Free, Built-in)</option>
            <option value="elevenlabs">ElevenLabs (High Quality)</option>
            <option value="openai">OpenAI Whisper (Best Accuracy)</option>
            <option value="google">Google Speech-to-Text</option>
            <option value="deepgram">Deepgram (Fast & Accurate)</option>
          </select>
          <div class="hint">Web Speech API is free and works offline. Cloud providers require API keys but offer better accuracy.</div>
        </div>

        <div class="form-group" id="elevenlabsKeyGroup" style="display: none;">
          <label for="elevenlabsApiKey">ElevenLabs API Key</label>
          <input type="text" id="elevenlabsApiKey" placeholder="sk_...">
          <div class="hint">Get your API key at <a href="https://elevenlabs.io/app/speech-synthesis/speech-to-text" target="_blank">ElevenLabs Speech-to-Text</a></div>
        </div>

        <div class="form-group" id="googleVoiceKeyGroup" style="display: none;">
          <label for="googleVoiceApiKey">Google API Key</label>
          <input type="text" id="googleVoiceApiKey" placeholder="AIza...">
          <div class="hint">Use the same Google AI Studio API key or get a Speech-to-Text key at <a href="https://console.cloud.google.com/" target="_blank">Google Cloud Console</a></div>
        </div>

        <div class="form-group" id="deepgramKeyGroup" style="display: none;">
          <label for="deepgramApiKey">Deepgram API Key</label>
          <input type="text" id="deepgramApiKey" placeholder="...">
          <div class="hint">Get your API key at <a href="https://console.deepgram.com/" target="_blank">Deepgram Console</a></div>
        </div>

        <div class="form-group">
          <label for="voiceLanguage">Language</label>
          <select id="voiceLanguage">
            <option value="en">English</option>
            <option value="es">Spanish</option>
            <option value="fr">French</option>
            <option value="de">German</option>
            <option value="it">Italian</option>
            <option value="pt">Portuguese</option>
            <option value="zh">Chinese</option>
            <option value="ja">Japanese</option>
            <option value="ko">Korean</option>
            <option value="ar">Arabic</option>
            <option value="hi">Hindi</option>
            <option value="bn">Bengali</option>
          </select>
          <div class="hint">Select the language you'll be speaking in</div>
        </div>

        <button type="submit" class="btn">Save Voice Settings</button>
        <div id="voiceStatus" class="status"></div>
      </form>
    </div>

    <div class="section">
      <h2>📖 How to Use</h2>
      <ol style="padding-left: 20px; font-size: 12px; color: #666; line-height: 1.8;">
        <li>Open any messaging platform (WhatsApp Web, Instagram, etc.)</li>
        <li>Click on a message input field</li>
        <li>Look for the floating 🧛 Gracula button</li>
        <li>Click it and select your desired tone</li>
        <li>Choose from generated replies and insert!</li>
      </ol>
    </div>
  </div>

  <div class="footer">
    Made with 🧛 by Gracula Team<br>
    <a href="https://github.com" target="_blank">GitHub</a> • 
    <a href="#" id="reportIssue">Report Issue</a>
  </div>

  <script src="popup.js"></script>
</body>
</html>

